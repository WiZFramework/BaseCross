<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<link href="css/main.css" rel="stylesheet" type="text/css">
<title>BaseCrossドキュメント(2017年)</title>
</head>
<body>
<!-- 全体コンテナ　-->
<div id="container">
<div id="header">
<h2>２．BaseCrossの構造と使い方</h2>
</div>
<!-- コンテンツ　-->
<div id="contents">
<br/>
<h3>２０１．BaseCrossの全体の構成</h3>
　この章の目的は<b>BaseCrossの構造と使い方</b>を考察、レポートするものです。<br />
　<b>マニュアル</b>とはちょっと違う形で考えてます。といいますのは、<b>BaseCross</b>はこれまでもそうであったように、常にライブラリが修正され、機能追加される<b>ゲームミドルウェア</b>です。<br />
　そのため<b>マニュアル</b>という<b>Fixされた</b>ものとは違い<b>現時点の</b>という意味合いが強いと考えています。<br />
　ですから、このドキュメントも常に修正される可能性があるものと考えていただければと思います。<br />
　また、<b>すべての機能</b>を網羅できるものではありません。中には<b>ほとんど実行される可能性は低いが実装されいる</b>機能もあります。こういったものについてはこのドキュメントに記述されない場合も多々あります。<br />
　これらの<b>あまり使われない機能</b>は、将来的にはライブラリから削除されるか、もしくは形を変えて再実装される可能性があります。<br />
　また、このドキュメントは<b>考察、レポート</b>の意味もあります。<b>現時点ではこのように実装されているが、本当は別の形がいいかもしれない</b>といった内容も含まれます。<br />
　ですから、もし、現在の実装よりももっといい考え方、あるいは効率的な記述方法があれば、<br/>
<br/><b>
BaseCrossゲームフレームワーク<br />
開発日誌 -実験と実装と-<br />
<a href="http://gameproject.jp/" target="_blank">http://gameproject.jp/</a><br />
</b>
<br />
　から、お問い合せいただければ、幸いです。<br />
　また、この章の内容は基本的にサンプルはありませんので、コードを確認する場合はライブラリディレクトリ内を各自参照してください。サンプルがあったほうが理解しやすいと思われる項に関しては、サンプルを用意し、その旨記述いたします。
<br />
<h4>BaseCrossの全体の構成</h4>
　さて、この項のテーマは<b>BaseCrossの構造</b>です。ここで<b>BaseCross</b>というのは<b>BaseCrossフルバージョン</b>のことです。<br />
　<b>シンプルバージョン</b>はここで説明する機能はほとんど実装されません。ただ<b>SimpleSample015</b>などは<b>BaseCrossフルバージョン</b>の機能を<b>シンプルバージョンに実装する方法</b>としてのサンプルが設置されてますので、そちらではこのドキュメントは、ほぼ有効と言えます。<br />
<br />
　<b>BaseCross</b>の基本的なクラス階層は以下のようになってます。
<p>&nbsp;</p>
<img src="img/0201a.png" width="80%"/>
<p>図0201a</p>
<p>&nbsp;</p>
<br/>
　この階層図は、<b>一番ざっくりとした</b>階層図です。<br />
　まず、BaseCrossの一番上位に位置しているクラスが<b>Appクラス</b>となります。このクラスは<b>シングルトン</b>として、<b>WinMain.cpp内</b>で作成されます。<br />
　作成するには<b>App::CreateApp()関数</b>を使用します。<br />
　この関数を実行した後は、ゲーム中どこからでも<b>App::GetApp()関数</b>でシングルトンのインスタンスにアクセスできます。<br/>
　<b>Appクラス</b>に含まれる<b>DeviceResourceクラス</b>は<b>描画用のライブラリ</b>です。これは<b>Dx11、Dx12そして将来的にはOplenGLも</b>対応するクラスです。ここでは詳しくは述べません。<br />
<br />
　同様に<b>Appクラス</b>に含まれる<b>SceneInterfaceクラス</b>は、<b>シーン</b>の親クラスとなります。以下のような階層を持ってます。
<p>&nbsp;</p>
<img src="img/0201b.png" width="60%"/>
<p>図0201b</p>
<p>&nbsp;</p>
　<b>シンプルバージョン</b>では、この<b>SceneInterfaceクラス</b>の派生クラスとして<b>シーン</b>もしくは<b>ステージ</b>などを作成します。その場合、必ずしも<b>Scene</b>や<b>Stage</b>などの名前も必要ではありません。<b>ゲーム盤</b>を表現できるものであれば自分で決められます。<br />
　<b>フルバージョン</b>はいわば<b>ライブラリ作成の1つの形</b>であり、その例として<b>SceneBase</b>および<b>Stage</b>という階層を使っているというわけです。<br />
　<b>フルバージョンに含まれるクラス</b>は<b>Libs</b>フィルタの<b>SharedLib</b>内にまとめられています。また描画系のフルバージョンライブラリは、Dx11であれば<b>Dx11FulLib</b>フィルタにまとめてあります。<br/>
　シングルトンである<b>Appクラス</b>に<b>1つだけ</b>含まれるのが<b>SceneInterfaceクラス（のポインタ）</b>です。フルバージョンではここに<b>Sceneのポインタ</b>が代入されます。<br />
　ここで<b>ポインタ</b>というのはすべて<b>スマートポインタ</b>です。<b>BaseCross</b>は<b>C++11</b>のコードです。ですから<b>C言語由来のポインタ</b>を使うことはほとんどありません。<b>C言語由来のポインタ</b>の場合は<b>生ポインタ</b>と表現します。<br />
<br />
　このように唯一の<b>Appクラス</b>に含まれる一つの<b>Scene</b>ですから、当然<b>Sceneのインスタンス</b>も一つになります。<b>Appクラス</b>のようにシングルトンではありませんが、ほかにインスタンスを作成するメリットはありません。<br />
　<b>SceneBaseクラス</b>は<b>Sceneの親クラス</b>です。この中に<b>アクティブなステージ</b>を<b>1つだけ</b>含むことができます。<br />
　<b>ステージ</b>は<b>Stageクラスの派生クラス</b>として作成します。そうすると<b>シーン</b>に含めることができるようになります。<br />
<br />
　この項では、全体の構成を説明しました。次項では<b>Stageクラス</b>について説明します。
</div>
<!-- /コンテンツ　-->
<hr>
<!-- フッタ　-->
<ul class="foot_navi">
<li><a href="index.html">目次</a></li>
<li><a href="02_02.html">次へ</a></li>
</ul>
<!-- /フッタ　-->


</div>
<!-- /全体コンテナ　-->
</body>
</html>
